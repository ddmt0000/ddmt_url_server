<h1>DDMT add</h1>
<p>输入原始链接：</p>
<mdui-text-field class="example-text" prefix="" label="url"><mdui-icon name="content_paste"
        slot="end-icon"></mdui-icon></mdui-text-field>
<p></p>
<mdui-text-field readonly id="newurl" value="newurl" style="display:none;"><mdui-icon name="content_copy"
        slot="end-icon"></mdui-icon></mdui-text-field>
<p></p>
<mdui-button full-width onclick="add_url();"><mdui-icon name='add_link'></mdui-icon>add</mdui-button>
<mdui-snackbar class="example-snackbar">Photo archived</mdui-snackbar>
<script>
    const snackbar = document.querySelector(".example-snackbar");
    const urlprint = document.querySelector("mdui-text-field[id='newurl']");
    function add_url() {
        var urlInput = document.querySelector("mdui-text-field");
        var submitbutton = document.querySelector("mdui-button");
        var url = urlInput.value;
        submitbutton.loading = true;
        console.log(submitbutton.loading);        var xhr = new XMLHttpRequest();
        xhr.open("GET", "/?mod=add&url_orange=" + encodeURIComponent(url), true);
        xhr.onreadystatechange = function () {
            if (xhr.readyState === 4 && xhr.status === 200) {
                // 请求成功
                var response = JSON.parse(xhr.responseText);
                var code = response.code;
                var newUrl = response.newurl;
                var msg = response.msg;                console.log("code: " + code);
                console.log("newUrl: " + newUrl);
                console.log("msg: " + msg);
                if (code == 1) {
                    snackbar.innerHTML = msg;
                    urlprint.value = newUrl;
                    snackbar.open = true;
                    urlprint.style.display = "block"
                } else {
                    snackbar.innerHTML = msg;
                    urlprint.style.display = "none"
                    snackbar.open = true;
                }
            } else {
                if (xhr.readyState >= 4 && xhr.status != 200) {
                    snackbar.innerHTML = "请求失败";
                    snackbar.open = true
                }
            }
        };
        submitbutton.loading = false;
        xhr.send();
    }
</script>